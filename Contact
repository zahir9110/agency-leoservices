import React, { useState } from 'react';
import { motion } from 'framer-motion';
import { Link } from 'react-router-dom';
import { createPageUrl } from '@/utils';
import { 
  Bot, 
  Mail, 
  MapPin,
  Send,
  MessageCircle,
  ArrowRight,
  Sparkles,
  BookOpen,
  Headphones
} from 'lucide-react';
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import { 
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import MobileMenu from '@/components/MobileMenu';
import SmartChatBot from '@/components/SmartChatBot';
import { base44 } from '@/api/base44Client';

const blogPosts = [
  {
    title: "5 façons d'automatiser votre service client avec l'IA",
    excerpt: "Découvrez comment les chatbots IA peuvent transformer votre relation client...",
    date: "15 Nov 2025",
    readTime: "5 min"
  },
  {
    title: "Guide complet : Automatiser sa prospection email",
    excerpt: "Les meilleures pratiques pour des campagnes email automatisées efficaces...",
    date: "10 Nov 2025",
    readTime: "8 min"
  },
  {
    title: "n8n vs Make : Quel outil choisir pour votre entreprise?",
    excerpt: "Comparatif détaillé des deux plateformes d'automatisation les plus populaires...",
    date: "5 Nov 2025",
    readTime: "6 min"
  }
];

export default function Contact() {
  // Get service from URL params
  const urlParams = new URLSearchParams(window.location.search);
  const preselectedService = urlParams.get('service') || '';
  
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    phone: '',
    company: '',
    service: preselectedService,
    message: ''
  });
  const [isSubmitting, setIsSubmitting] = useState(false);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    
    // Enregistrer le prospect dans le CRM
    await base44.entities.Prospect.create({
      name: formData.name,
      email: formData.email,
      company: formData.company,
      service_interest: formData.service || 'other',
      message: formData.message,
      source: 'contact_form',
      status: 'new'
    });
    
    setIsSubmitting(false);
    setFormData({ name: '', email: '', phone: '', company: '', service: '', message: '' });
    alert('Message envoyé avec succès! Nous vous contacterons sous 24h.');
  };

  return (
    <div className="min-h-screen bg-[#0a0a0a] text-white">
      {/* Navigation */}
      <nav className="sticky top-0 z-50 bg-black/95 backdrop-blur-lg border-b border-[#00ff41]/30 shadow-[0_0_20px_rgba(0,255,65,0.2)]">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <Link to={createPageUrl('Home')} className="flex items-center gap-2 text-[#00ff41] font-bold text-xl">
              <Bot className="w-7 h-7 animate-pulse" />
              <span className="font-mono tracking-tight">Agency Leo</span>
            </Link>
            <MobileMenu />
          </div>
        </div>
      </nav>

      {/* Hero */}
      <section className="py-16 lg:py-24 relative overflow-hidden">
        <div className="absolute inset-0 bg-gradient-to-br from-black via-[#0a0a0a] to-[#001a0d]" />
        <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
          <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }}>
            <span className="inline-block px-4 py-2 mb-6 text-sm font-semibold text-[#00ff41] bg-[#00ff41]/10 border border-[#00ff41]/30 rounded-full uppercase tracking-wider">
              <MessageCircle className="inline w-4 h-4 mr-2" />
              Contact & Support
            </span>
            <h1 className="text-4xl sm:text-5xl lg:text-6xl font-black mb-6">
              Parlons de votre <span className="text-[#00ff41]">Projet</span>
            </h1>
            <p className="text-lg sm:text-xl text-gray-400 max-w-3xl mx-auto">
              Consultation gratuite, blog et support assisté par IA
            </p>
          </motion.div>
        </div>
      </section>

      {/* Main Content */}
      <section className="py-16">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="grid lg:grid-cols-2 gap-12 lg:gap-20">
            {/* Contact Form */}
            <motion.div
              initial={{ opacity: 0, x: -20 }}
              whileInView={{ opacity: 1, x: 0 }}
              viewport={{ once: true }}
            >
              <h2 className="text-2xl sm:text-3xl font-black mb-6">
                <Sparkles className="inline w-6 h-6 text-[#00ff41] mr-2" />
                Consultation Gratuite
              </h2>
              
              <form onSubmit={handleSubmit} className="bg-[#1a1a1a] border border-[#2a2a2a] rounded-2xl p-6 sm:p-8">
                <div className="grid sm:grid-cols-2 gap-5">
                  <div>
                    <label className="block text-sm font-medium text-gray-400 mb-2">Nom complet *</label>
                    <Input
                      value={formData.name}
                      onChange={(e) => setFormData({...formData, name: e.target.value})}
                      required
                      className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41]"
                      placeholder="Jean Dupont"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-400 mb-2">Email *</label>
                    <Input
                      type="email"
                      value={formData.email}
                      onChange={(e) => setFormData({...formData, email: e.target.value})}
                      required
                      className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41]"
                      placeholder="jean@entreprise.ca"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-400 mb-2">Téléphone</label>
                    <Input
                      value={formData.phone}
                      onChange={(e) => setFormData({...formData, phone: e.target.value})}
                      className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41]"
                      placeholder="+1 (438) 000-0000"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-400 mb-2">Entreprise</label>
                    <Input
                      value={formData.company}
                      onChange={(e) => setFormData({...formData, company: e.target.value})}
                      className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41]"
                      placeholder="Nom de votre entreprise"
                    />
                  </div>
                </div>
                
                <div className="mt-5">
                  <label className="block text-sm font-medium text-gray-400 mb-2">Service souhaité</label>
                  <Select value={formData.service} onValueChange={(value) => setFormData({...formData, service: value})}>
                    <SelectTrigger className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41]">
                      <SelectValue placeholder="Sélectionnez un service" />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="chatbot">Chatbot IA</SelectItem>
                      <SelectItem value="automation">Automatisation des flux</SelectItem>
                      <SelectItem value="prospection">Prospection automatisée</SelectItem>
                      <SelectItem value="rdv">Gestion de rendez-vous</SelectItem>
                      <SelectItem value="integration">Intégrations sur-mesure</SelectItem>
                      <SelectItem value="other">Autre</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                <div className="mt-5">
                  <label className="block text-sm font-medium text-gray-400 mb-2">Message *</label>
                  <Textarea
                    value={formData.message}
                    onChange={(e) => setFormData({...formData, message: e.target.value})}
                    required
                    rows={4}
                    className="bg-[#0a0a0a] border-[#2a2a2a] text-white focus:border-[#00ff41] resize-none"
                    placeholder="Décrivez votre projet ou vos besoins..."
                  />
                </div>

                <Button 
                  type="submit"
                  disabled={isSubmitting}
                  className="w-full mt-6 bg-[#00ff41] text-black hover:bg-[#00cc33] font-bold py-6 text-lg shadow-[0_0_20px_rgba(0,255,65,0.3)]"
                >
                  {isSubmitting ? 'Envoi en cours...' : 'Envoyer le Message'}
                  <Send className="ml-2 w-5 h-5" />
                </Button>
              </form>
            </motion.div>

            {/* Right Column */}
            <motion.div
              initial={{ opacity: 0, x: 20 }}
              whileInView={{ opacity: 1, x: 0 }}
              viewport={{ once: true }}
              className="space-y-8"
            >
              {/* Contact Info */}
              <div className="bg-[#1a1a1a] border border-[#2a2a2a] rounded-2xl p-6">
                <h3 className="text-xl font-bold mb-6 flex items-center gap-2">
                  <Mail className="w-5 h-5 text-[#00ff41]" />
                  Nous contacter
                </h3>
                <div className="space-y-4">

                  <a href="mailto:agency-leoservices@zohomailcloud.ca" className="flex items-center gap-4 p-3 rounded-xl hover:bg-[#00ff41]/5 transition-colors">
                    <div className="w-12 h-12 rounded-xl bg-[#00ff41]/10 flex items-center justify-center">
                      <Mail className="w-5 h-5 text-[#00ff41]" />
                    </div>
                    <div>
                      <p className="text-sm text-gray-500">Email</p>
                      <p className="text-white font-medium">agency-leoservices@zohomailcloud.ca</p>
                    </div>
                  </a>
                  <div className="flex items-center gap-4 p-3 rounded-xl">
                    <div className="w-12 h-12 rounded-xl bg-[#00ff41]/10 flex items-center justify-center">
                      <MapPin className="w-5 h-5 text-[#00ff41]" />
                    </div>
                    <div>
                      <p className="text-sm text-gray-500">Adresse</p>
                      <p className="text-white font-medium">Montréal, QC, Canada</p>
                    </div>
                  </div>

                </div>
              </div>

              {/* AI Support */}
              <div className="bg-gradient-to-br from-[#00ff41]/10 to-[#1a1a1a] border border-[#00ff41]/30 rounded-2xl p-6">
                <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                  <Headphones className="w-5 h-5 text-[#00ff41]" />
                  Support IA 24/7
                </h3>
                <p className="text-gray-400 mb-4">
                  Notre assistant IA est disponible à tout moment pour répondre à vos questions.
                </p>
                <Button 
                  className="w-full bg-[#00ff41] text-black hover:bg-[#00cc33] font-semibold"
                  onClick={() => document.querySelector('[aria-label="Menu"]')?.click()}
                >
                  <Bot className="mr-2 w-5 h-5" />
                  Parler à l'Assistant IA
                </Button>
              </div>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Blog Section */}
      <section className="py-16 bg-[#0f0f0f]">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <motion.div
            className="text-center mb-12"
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
          >
            <h2 className="text-3xl sm:text-4xl font-black mb-4">
              <BookOpen className="inline w-8 h-8 text-[#00ff41] mr-2" />
              Notre <span className="text-[#00ff41]">Blog</span>
            </h2>
            <p className="text-gray-400">
              Conseils et actualités sur l'automatisation IA
            </p>
          </motion.div>

          <div className="grid md:grid-cols-3 gap-6">
            {blogPosts.map((post, index) => (
              <motion.article
                key={index}
                className="bg-[#1a1a1a] border border-[#2a2a2a] rounded-2xl p-6 hover:border-[#00ff41]/50 transition-all cursor-pointer group"
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.1 }}
                viewport={{ once: true }}
                whileHover={{ y: -5 }}
              >
                <div className="flex items-center gap-3 text-sm text-gray-500 mb-4">
                  <span>{post.date}</span>
                  <span>•</span>
                  <span>{post.readTime} de lecture</span>
                </div>
                <h3 className="text-lg font-bold text-white mb-3 group-hover:text-[#00ff41] transition-colors">
                  {post.title}
                </h3>
                <p className="text-gray-400 text-sm mb-4">{post.excerpt}</p>
                <span className="text-[#00ff41] text-sm font-semibold flex items-center gap-1">
                  Lire l'article
                  <ArrowRight className="w-4 h-4 group-hover:translate-x-1 transition-transform" />
                </span>
              </motion.article>
            ))}
          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="py-12 bg-black border-t border-[#2a2a2a]">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex flex-col md:flex-row justify-between items-center gap-6">
            <div className="flex items-center gap-2 text-[#00ff41] font-bold text-xl">
              <Bot className="w-6 h-6" />
              <span className="font-mono">Agency Leo Services</span>
            </div>
            <div className="flex flex-wrap justify-center gap-6 text-sm text-gray-500">
              <Link to={createPageUrl('MentionsLegales')} className="hover:text-[#00ff41] transition-colors">
                Mentions Légales
              </Link>
              <Link to={createPageUrl('PolitiqueConfidentialite')} className="hover:text-[#00ff41] transition-colors">
                Politique de Confidentialité
              </Link>
            </div>
            <div className="text-sm text-gray-600">
              © 2025 Agency Leo Services
            </div>
          </div>
        </div>
      </footer>

      <SmartChatBot />
    </div>
  );
}
